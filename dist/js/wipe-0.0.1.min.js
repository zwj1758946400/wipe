/*!weip-zwj 0.0.1 发布日期: 18y-11-12*/
var moveX,moveY,con=document.getElementById("cas"),context=cas.getContext("2d"),radius=20,_w=cas.width,_h=cas.height,isMouseDown=!1;function drawMask(e){e.beginPath(),e.fillStyle="#666",e.fillRect(0,0,_w,_h),e.fill(),e.globalCompositeOperation="destination-out"}function drawarc(e,n,t){e.beginPath(),e.fillStyle="red",e.arc(n,t,radius,0,2*Math.PI),e.fill(),e.restore()}function drawLine(e,n,t,o,a){e.save(),e.lineCap="round",e.lineWidth=2*radius,e.beginPath(),e.moveTo(n,t),e.lineTo(o,a),e.lineJoin="round",e.stroke(),e.restore()}function drawarc(e,n,t){e.beginPath(),e.fillStyle="red",e.arc(n,t,radius,0,2*Math.PI),e.fill(),e.restore()}function fn1(e){if(!0===isMouseDown){var n=e||window.event,t=n.clientX,o=n.clientY;drawLine(context,moveX,moveY,t,o),moveX=t,moveY=o}}function getTransparencyPercent(e){for(var n=0,t=e.getImageData(0,0,_w,_h),o=0;o<t.data.length;o+=4){0===t.data[o+3]&&n++}var a=n/(_w*_h)*100;return console.log("透明的点个数是"+n),console.log("占总面积的"+Math.ceil(a)+"%"),Math.round(a)}function clearRect(e){e.clearRect(0,0,_w,_h)}cas.addEventListener("mousedown",function(e){isMouseDown=!0;var n=e||window.event;moveX=n.clientX,moveY=n.clientY,drawarc(context,moveX,moveY),cas.addEventListener("mousemove",fn1,!1)},!1),cas.addEventListener("mouseup",function(){isMouseDown=!1,50<getTransparencyPercent(context)&&(alert("超过了50%的面积"),clearRect(context))},!1),window.onload=function(){drawMask(context),drawarc(context),drawLine(context)};